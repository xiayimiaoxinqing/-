<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>激活码管理系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2c3e50, #1a2a6c);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 20px;
            position: relative;
        }
        
        .admin-control {
            position: absolute;
            top: 20px;
            right: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            background: linear-gradient(to right, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 20px;
            color: #e0e0e0;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 30px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.4s ease;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .card h2 {
            color: #fff;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            font-size: 1.6rem;
        }
        
        .card h2 i {
            margin-right: 12px;
            color: #3498db;
            font-size: 1.8rem;
        }
        
        .form-group {
            margin-bottom: 22px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #a0d2ff;
            font-size: 1.1rem;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px;
            background: rgba(0, 0, 0, 0.25);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: white;
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
            background: rgba(0, 0, 0, 0.35);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        button {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 17px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0,0,0,0.3);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .btn-success {
            background: linear-gradient(to right, #27ae60, #219653);
        }
        
        .btn-warning {
            background: linear-gradient(to right, #e67e22, #d35400);
        }
        
        .btn-purple {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
        }
        
        .btn-admin {
            background: linear-gradient(to right, #f39c12, #e67e22);
        }
        
        .activation-code {
            background: rgba(0, 0, 0, 0.3);
            border: 2px dashed #3498db;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 25px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #2ecc71;
            word-break: break-all;
            letter-spacing: 2px;
            font-family: 'Courier New', monospace;
        }
        
        .status-message {
            padding: 14px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .info {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .orders-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .orders-table th, .orders-table td {
            padding: 16px 20px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .orders-table th {
            background: rgba(52, 152, 219, 0.3);
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .orders-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .orders-table tr:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        .status-active {
            color: #2ecc71;
            font-weight: bold;
        }
        
        .status-returned {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .status-pending {
            color: #f39c12;
            font-weight: bold;
        }
        
        .action-btn {
            padding: 8px 15px;
            border-radius: 6px;
            background: rgba(52, 152, 219, 0.3);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        
        .action-btn:hover {
            background: rgba(52, 152, 219, 0.5);
        }
        
        footer {
            text-align: center;
            color: rgba(255,255,255,0.6);
            padding: 30px 0;
            margin-top: 40px;
            font-size: 0.95rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-box {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-width: 180px;
            margin: 10px;
            flex: 1;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: #a0d2ff;
            font-size: 1.1rem;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: rgba(52, 152, 219, 0.5);
        }
        
        .tab:hover {
            background: rgba(52, 152, 219, 0.3);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .code-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .code-item:last-child {
            border-bottom: none;
        }
        
        .code-value {
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
        }
        
        .code-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-left: 15px;
        }
        
        .status-available {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .status-used {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }
        
        .status-returned {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .customer-view {
            max-width: 600px;
            margin: 50px auto;
        }
        
        .admin-panel {
            display: none;
        }
        
        .customer-panel {
            display: block;
        }
        
        .admin-mode .customer-panel {
            display: none;
        }
        
        .admin-mode .admin-panel {
            display: block;
        }
        
        .admin-mode .admin-control .admin-btn {
            background: linear-gradient(to right, #e74c3c, #c0392b);
        }
        
        .instructions {
            margin: 20px auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            max-width: 800px;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #4facfe;
        }
        
        .instructions ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .instructions .highlight {
            color: #2ecc71;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .card-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .stat-box {
                flex-direction: column;
            }
            
            .admin-control {
                position: relative;
                top: 0;
                margin: 20px 0;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-key"></i> 激活码管理系统</h1>
            <p class="subtitle">客户凭订单领取激活码 • 管理员全面管理系统</p>
            
            <div class="admin-control">
                <input type="password" id="adminPassword" placeholder="qq269948311" style="display:none">
                <button id="adminBtn" class="btn-admin admin-btn">
                    <i class="fas fa-lock"></i> 管理员登录
                </button>
            </div>
        </header>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> 系统使用说明</h3>
            <ol>
                <li><span class="highlight">客户使用</span>：输入订单编号，点击"领取激活码"按钮获取激活码</li>
                <li><span class="highlight">管理员登录</span>：点击右上角"管理员登录"，密码为<span class="highlight">qq269948311</span></li>
                <li><span class="highlight">管理员功能</span>：添加激活码、录入订单、处理退货、查看所有数据</li>
                <li><span class="highlight">退出管理员模式</span>：管理员模式下点击"退出管理员模式"按钮</li>
            </ol>
            <p><i class="fas fa-exclamation-triangle"></i> 注意：所有数据存储在浏览器内存中，刷新页面会丢失数据</p>
        </div>
        
        <!-- 客户视图 -->
        <div class="customer-panel">
            <div class="customer-view">
                <div class="card">
                    <h2><i class="fas fa-download"></i> 激活码领取</h2>
                    <div class="form-group">
                        <label for="customerOrderId"><i class="fas fa-barcode"></i> 订单编号</label>
                        <input type="text" id="customerOrderId" placeholder="输入您的订单编号">
                    </div>
                    <button id="customerClaimBtn">
                        <i class="fas fa-key"></i> 领取激活码
                    </button>
                    <div class="activation-code" id="customerActivationCode" style="display:none">
                        等待领取激活码...
                    </div>
                    <div class="status-message" id="customerStatus"></div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-info-circle"></i> 使用说明</h2>
                    <div class="status-message info">
                        <p><i class="fas fa-check-circle"></i> 1. 输入您的订单编号</p>
                        <p><i class="fas fa-check-circle"></i> 2. 点击"领取激活码"按钮</p>
                        <p><i class="fas fa-check-circle"></i> 3. 成功后会显示您的激活码</p>
                        <p><i class="fas fa-exclamation-triangle"></i> 注意：每个订单只能领取一次激活码</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 管理员视图 -->
        <div class="admin-panel">
            <div class="stat-box">
                <div class="stat-item">
                    <div class="stat-value" id="totalOrders">24</div>
                    <div class="stat-label">总订单数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="activeCodes">18</div>
                    <div class="stat-label">已激活</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="availableCodes">86</div>
                    <div class="stat-label">可用激活码</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="returnedCodes">2</div>
                    <div class="stat-label">已退货</div>
                </div>
            </div>
            
            <div class="card-container">
                <div class="card">
                    <h2><i class="fas fa-plus-circle"></i> 激活码管理</h2>
                    <div class="tabs">
                        <div class="tab active" data-tab="single">单个添加</div>
                        <div class="tab" data-tab="batch">批量添加</div>
                    </div>
                    
                    <div class="tab-content active" id="singleTab">
                        <div class="form-group">
                            <label for="activationCode"><i class="fas fa-barcode"></i> 激活码</label>
                            <input type="text" id="activationCode" placeholder="输入激活码（例: ABCD-EFGH-IJKL-MNOP）">
                        </div>
                        <div class="form-group">
                            <label for="productType"><i class="fas fa-box"></i> 产品类型</label>
                            <select id="productType">
                                <option value="pro">专业版</option>
                                <option value="enterprise">企业版</option>
                                <option value="ultimate">旗舰版</option>
                                <option value="basic">基础版</option>
                            </select>
                        </div>
                        <button id="addCodeBtn" class="btn-purple">
                            <i class="fas fa-save"></i> 添加激活码
                        </button>
                    </div>
                    
                    <div class="tab-content" id="batchTab">
                        <div class="form-group">
                            <label for="batchCodes"><i class="fas fa-list"></i> 批量激活码</label>
                            <textarea id="batchCodes" placeholder="每行输入一个激活码&#10;例如：&#10;ABCD-1234-EFGH-5678&#10;WXYZ-9012-LKJH-3456"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="batchProductType"><i class="fas fa-box"></i> 产品类型</label>
                            <select id="batchProductType">
                                <option value="pro">专业版</option>
                                <option value="enterprise">企业版</option>
                                <option value="ultimate">旗舰版</option>
                                <option value="basic">基础版</option>
                            </select>
                        </div>
                        <button id="addBatchBtn" class="btn-purple">
                            <i class="fas fa-file-import"></i> 批量添加激活码
                        </button>
                    </div>
                    
                    <div class="status-message" id="codeStatus"></div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-file-invoice"></i> 订单管理</h2>
                    <div class="form-group">
                        <label for="orderId"><i class="fas fa-barcode"></i> 订单编号</label>
                        <input type="text" id="orderId" placeholder="输入订单编号（例: ORD20230625001）">
                    </div>
                    <button id="addOrderBtn" class="btn-success">
                        <i class="fas fa-save"></i> 保存订单信息
                    </button>
                    <div class="status-message" id="orderStatus"></div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-download"></i> 激活码领取</h2>
                    <div class="form-group">
                        <label for="claimOrderId"><i class="fas fa-barcode"></i> 订单编号</label>
                        <input type="text" id="claimOrderId" placeholder="输入订单编号">
                    </div>
                    <button id="claimCodeBtn">
                        <i class="fas fa-key"></i> 领取激活码
                    </button>
                    <div class="activation-code" id="activationCodeDisplay" style="display:none">
                        等待领取激活码...
                    </div>
                    <div class="status-message" id="claimStatus"></div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-undo-alt"></i> 退货管理</h2>
                    <div class="form-group">
                        <label for="returnOrderId"><i class="fas fa-barcode"></i> 订单编号</label>
                        <input type="text" id="returnOrderId" placeholder="输入要退货的订单编号">
                    </div>
                    <div class="form-group">
                        <label for="returnReason"><i class="fas fa-exclamation-triangle"></i> 退货原因</label>
                        <select id="returnReason">
                            <option value="change">改变主意</option>
                            <option value="defect">产品缺陷</option>
                            <option value="wrong">购买错误</option>
                            <option value="other">其他原因</option>
                        </select>
                    </div>
                    <button id="returnBtn" class="btn-warning">
                        <i class="fas fa-exchange-alt"></i> 执行退货操作
                    </button>
                    <div class="status-message" id="returnStatus"></div>
                </div>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-list"></i> 订单状态列表</h2>
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>订单编号</th>
                            <th>激活码</th>
                            <th>产品类型</th>
                            <th>状态</th>
                            <th>操作时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <tr>
                            <td>ORD20230625001</td>
                            <td>XKJ8-7G2H-9F3D-1P5Q</td>
                            <td>专业版</td>
                            <td class="status-active">已激活</td>
                            <td>2023-06-25 10:23</td>
                            <td><button class="action-btn">详情</button></td>
                        </tr>
                        <tr>
                            <td>ORD20230624005</td>
                            <td>RT6Y-8U1I-0O9P-4L3K</td>
                            <td>企业版</td>
                            <td class="status-returned">已退货</td>
                            <td>2023-06-24 15:47</td>
                            <td><button class="action-btn">详情</button></td>
                        </tr>
                        <tr>
                            <td>ORD20230623012</td>
                            <td>MNB7-VC6X-2Z1A-9Q8W</td>
                            <td>旗舰版</td>
                            <td class="status-active">已激活</td>
                            <td>2023-06-23 09:12</td>
                            <td><button class="action-btn">详情</button></td>
                        </tr>
                        <tr>
                            <td>ORD20230622008</td>
                            <td>-</td>
                            <td>基础版</td>
                            <td class="status-pending">未激活</td>
                            <td>2023-06-22 14:30</td>
                            <td><button class="action-btn">详情</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-key"></i> 激活码库存</h2>
                <div id="codeListContainer">
                    <!-- 激活码列表将通过JS动态生成 -->
                </div>
            </div>
        </div>
        
        <footer>
            <p>激活码管理系统 &copy; 2023 | 客户视图 | 管理员视图</p>
            <p>每个订单仅可领取一个激活码 | 退货需管理员操作</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 模拟数据存储
            let orders = [
                {
                    id: 'ORD20230625001',
                    code: 'XKJ8-7G2H-9F3D-1P5Q',
                    product: '专业版',
                    status: 'active',
                    date: '2023-06-25 10:23'
                },
                {
                    id: 'ORD20230624005',
                    code: 'RT6Y-8U1I-0O9P-4L3K',
                    product: '企业版',
                    status: 'returned',
                    date: '2023-06-24 15:47'
                },
                {
                    id: 'ORD20230623012',
                    code: 'MNB7-VC6X-2Z1A-9Q8W',
                    product: '旗舰版',
                    status: 'active',
                    date: '2023-06-23 09:12'
                },
                {
                    id: 'ORD20230622008',
                    code: '',
                    product: '基础版',
                    status: 'pending',
                    date: '2023-06-22 14:30'
                }
            ];
            
            let activationCodes = [
                { code: 'ABCD-1234-EFGH-5678', status: 'available', product: '专业版' },
                { code: 'WXYZ-9012-LKJH-3456', status: 'available', product: '企业版' },
                { code: 'PQRS-6789-MNOP-0123', status: 'used', product: '旗舰版' },
                { code: 'UVWX-4567-YZAB-8901', status: 'available', product: '基础版' },
                { code: 'CDEF-2345-GHIJ-6789', status: 'returned', product: '专业版' }
            ];
            
            // 管理员状态
            let isAdminMode = false;
            const adminPassword = "admin123"; // 管理员密码
            
            // 更新统计信息
            function updateStats() {
                const total = orders.length;
                const active = orders.filter(o => o.status === 'active').length;
                const pending = orders.filter(o => o.status === 'pending').length;
                const returned = orders.filter(o => o.status === 'returned').length;
                const available = activationCodes.filter(c => c.status === 'available').length;
                
                document.getElementById('totalOrders').textContent = total;
                document.getElementById('activeCodes').textContent = active;
                document.getElementById('pendingCodes').textContent = pending;
                document.getElementById('returnedCodes').textContent = returned;
                document.getElementById('availableCodes').textContent = available;
            }
            
            // 管理员登录
            document.getElementById('adminBtn').addEventListener('click', function() {
                if (!isAdminMode) {
                    const password = prompt("请输入管理员密码:");
                    if (password === adminPassword) {
                        document.body.classList.add('admin-mode');
                        isAdminMode = true;
                        this.innerHTML = '<i class="fas fa-lock-open"></i> 退出管理员模式';
                        document.getElementById('adminPassword').style.display = 'none';
                        updateCodeList();
                        updateOrdersTable();
                        updateStats();
                    } else if (password !== null) {
                        alert("密码错误！");
                    }
                } else {
                    document.body.classList.remove('admin-mode');
                    isAdminMode = false;
                    this.innerHTML = '<i class="fas fa-lock"></i> 管理员登录';
                }
            });
            
            // 客户领取激活码
            document.getElementById('customerClaimBtn').addEventListener('click', function() {
                const orderId = document.getElementById('customerOrderId').value.trim();
                const statusEl = document.getElementById('customerStatus');
                const codeDisplay = document.getElementById('customerActivationCode');
                
                if (!orderId) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请输入订单编号！';
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                const order = orders.find(o => o.id === orderId);
                
                if (!order) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 不存在！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                if (order.status === 'returned') {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 已退货，无法领取激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                if (order.status === 'active') {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 已领取过激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                // 查找可用激活码
                const availableCode = activationCodes.find(c => c.status === 'available');
                
                if (!availableCode) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 当前没有可用激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                // 分配激活码
                order.code = availableCode.code;
                order.product = availableCode.product;
                order.status = 'active';
                order.date = new Date().toLocaleString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // 更新激活码状态
                availableCode.status = 'used';
                
                updateOrdersTable();
                updateCodeList();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 激活码领取成功！`;
                
                codeDisplay.textContent = availableCode.code;
                codeDisplay.style.display = 'block';
                
                // 清空输入框
                document.getElementById('customerOrderId').value = '';
            });
            
            // 标签切换功能
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // 移除所有活动标签
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    // 隐藏所有内容
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // 激活当前标签
                    this.classList.add('active');
                    // 显示对应内容
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId + 'Tab').classList.add('active');
                });
            });
            
            // 添加新订单
            document.getElementById('addOrderBtn').addEventListener('click', function() {
                const orderId = document.getElementById('orderId').value.trim();
                const statusEl = document.getElementById('orderStatus');
                
                if (!orderId) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请填写订单编号！';
                    return;
                }
                
                // 检查订单是否已存在
                if (orders.some(order => order.id === orderId)) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 已存在！`;
                    return;
                }
                
                // 添加新订单
                const newOrder = {
                    id: orderId,
                    code: '',
                    product: '',
                    status: 'pending',
                    date: new Date().toLocaleString('zh-CN', { 
                        year: 'numeric', 
                        month: '2-digit', 
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    })
                };
                
                orders.push(newOrder);
                updateOrdersTable();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 订单 ${orderId} 添加成功！`;
                
                // 清空表单
                document.getElementById('orderId').value = '';
                
                // 3秒后清除成功消息
                setTimeout(() => {
                    statusEl.className = 'status-message';
                    statusEl.innerHTML = '';
                }, 3000);
            });
            
            // 添加激活码
            document.getElementById('addCodeBtn').addEventListener('click', function() {
                const code = document.getElementById('activationCode').value.trim();
                const product = document.getElementById('productType').options[document.getElementById('productType').selectedIndex].text;
                const statusEl = document.getElementById('codeStatus');
                
                if (!code) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请填写激活码！';
                    return;
                }
                
                // 检查激活码是否已存在
                if (activationCodes.some(c => c.code === code)) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 激活码 ${code} 已存在！`;
                    return;
                }
                
                // 添加新激活码
                activationCodes.push({
                    code: code,
                    status: 'available',
                    product: product
                });
                
                updateCodeList();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 激活码 ${code} 添加成功！`;
                
                // 清空表单
                document.getElementById('activationCode').value = '';
            });
            
            // 批量添加激活码
            document.getElementById('addBatchBtn').addEventListener('click', function() {
                const batchCodes = document.getElementById('batchCodes').value.trim();
                const product = document.getElementById('batchProductType').options[document.getElementById('batchProductType').selectedIndex].text;
                const statusEl = document.getElementById('codeStatus');
                
                if (!batchCodes) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请填写激活码列表！';
                    return;
                }
                
                const codes = batchCodes.split('\n').map(c => c.trim()).filter(c => c !== '');
                
                if (codes.length === 0) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 未检测到有效的激活码！';
                    return;
                }
                
                let addedCount = 0;
                let skippedCount = 0;
                
                codes.forEach(code => {
                    // 检查激活码是否已存在
                    if (!activationCodes.some(c => c.code === code)) {
                        activationCodes.push({
                            code: code,
                            status: 'available',
                            product: product
                        });
                        addedCount++;
                    } else {
                        skippedCount++;
                    }
                });
                
                updateCodeList();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 成功添加 ${addedCount} 个激活码，跳过 ${skippedCount} 个重复激活码！`;
                
                // 清空表单
                document.getElementById('batchCodes').value = '';
            });
            
            // 管理员领取激活码
            document.getElementById('claimCodeBtn').addEventListener('click', function() {
                const orderId = document.getElementById('claimOrderId').value.trim();
                const statusEl = document.getElementById('claimStatus');
                const codeDisplay = document.getElementById('activationCodeDisplay');
                
                if (!orderId) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请输入订单编号！';
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                const order = orders.find(o => o.id === orderId);
                
                if (!order) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 不存在！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                if (order.status === 'returned') {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 已退货，无法领取激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                if (order.status === 'active') {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 已领取过激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                // 查找可用激活码
                const availableCode = activationCodes.find(c => c.status === 'available');
                
                if (!availableCode) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 当前没有可用激活码！`;
                    codeDisplay.style.display = 'none';
                    return;
                }
                
                // 分配激活码
                order.code = availableCode.code;
                order.product = availableCode.product;
                order.status = 'active';
                order.date = new Date().toLocaleString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // 更新激活码状态
                availableCode.status = 'used';
                
                updateOrdersTable();
                updateCodeList();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 激活码领取成功！`;
                
                codeDisplay.textContent = availableCode.code;
                codeDisplay.style.display = 'block';
                
                // 清空输入框
                document.getElementById('claimOrderId').value = '';
            });
            
            // 退货操作
            document.getElementById('returnBtn').addEventListener('click', function() {
                const orderId = document.getElementById('returnOrderId').value.trim();
                const statusEl = document.getElementById('returnStatus');
                
                if (!orderId) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> 请输入订单编号！';
                    return;
                }
                
                const order = orders.find(o => o.id === orderId);
                
                if (!order) {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 不存在！`;
                    return;
                }
                
                if (order.status !== 'active') {
                    statusEl.className = 'status-message error';
                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> 订单 ${orderId} 未激活，无法退货！`;
                    return;
                }
                
                // 更新激活码状态
                const code = activationCodes.find(c => c.code === order.code);
                if (code) {
                    code.status = 'returned';
                }
                
                // 执行退货
                order.status = 'returned';
                order.date = new Date().toLocaleString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                updateOrdersTable();
                updateCodeList();
                updateStats();
                
                statusEl.className = 'status-message success';
                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> 订单 ${orderId} 退货成功，激活码已失效！`;
                
                // 清空输入框
                document.getElementById('returnOrderId').value = '';
            });
            
            // 更新订单表格
            function updateOrdersTable() {
                const tbody = document.getElementById('ordersTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${order.id}</td>
                        <td>${order.code || '-'}</td>
                        <td>${order.product || '-'}</td>
                        <td class="status-${order.status}">
                            ${order.status === 'active' ? '已激活' : 
                              order.status === 'returned' ? '已退货' : '未激活'}
                        </td>
                        <td>${order.date}</td>
                        <td><button class="action-btn">详情</button></td>
                    `;
                    
                    tbody.appendChild(row);
                });
                
                // 添加详情按钮事件
                document.querySelectorAll('.action-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const orderId = this.closest('tr').children[0].textContent;
                        const order = orders.find(o => o.id === orderId);
                        if (order) {
                            alert(`订单详情\n编号: ${order.id}\n激活码: ${order.code || '无'}\n状态: ${order.status === 'active' ? '已激活' : order.status === 'returned' ? '已退货' : '未激活'}\n时间: ${order.date}`);
                        }
                    });
                });
            }
            
            // 更新激活码列表
            function updateCodeList() {
                const container = document.getElementById('codeListContainer');
                if (!container) return;
                
                container.innerHTML = '';
                
                activationCodes.forEach(code => {
                    const codeItem = document.createElement('div');
                    codeItem.className = 'code-item';
                    
                    let statusClass = 'status-available';
                    let statusText = '可用';
                    
                    if (code.status === 'used') {
                        statusClass = 'status-used';
                        statusText = '已使用';
                    } else if (code.status === 'returned') {
                        statusClass = 'status-returned';
                        statusText = '已退货';
                    }
                    
                    codeItem.innerHTML = `
                        <div class="code-value">${code.code}</div>
                        <div class="code-status ${statusClass}">${statusText}</div>
                    `;
                    
                    container.appendChild(codeItem);
                });
            }
            
            // 初始化页面
            updateStats();
        });
    </script>
</body>
</html>
